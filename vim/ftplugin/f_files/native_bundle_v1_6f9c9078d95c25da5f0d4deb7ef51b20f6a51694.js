/**
 * almond 0.2.5 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*! matches.js v1.0.3 - Nicolas Gallagher - MIT license */

/*! delegate.js v1.0.2 - Nicolas Gallagher - MIT license */

/*!
 * xdm.js – Nicolas Gallagher – MIT License
 * easyXDM – Copyright(c) 2009-2011, Øyvind Sean Kinsey, oyvind@kinsey.no – MIT License
 */

!function(){var e,t,n;!function(o){function r(e,t){return y.call(e,t)}function a(e,t){var n,o,r,a,i,c,l,s,u,d,f=t&&t.split("/"),p=v.map,m=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(f=f.slice(0,f.length-1),e=f.concat(e.split("/")),s=0;s<e.length;s+=1)if(d=e[s],"."===d)e.splice(s,1),s-=1;else if(".."===d){if(1===s&&(".."===e[2]||".."===e[0]))break;s>0&&(e.splice(s-1,2),s-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||m)&&p){for(n=e.split("/"),s=n.length;s>0;s-=1){if(o=n.slice(0,s).join("/"),f)for(u=f.length;u>0;u-=1)if(r=p[f.slice(0,u).join("/")],r&&(r=r[o])){a=r,i=s;break}if(a)break;!c&&m&&m[o]&&(c=m[o],l=s)}!a&&c&&(a=c,i=l),a&&(n.splice(0,i,a),e=n.join("/"))}return e}function i(e,t){return function(){return p.apply(o,C.call(arguments,0).concat([e,t]))}}function c(e){return function(t){return a(t,e)}}function l(e){return function(t){g[e]=t}}function s(e){if(r(E,e)){var t=E[e];delete E[e],_[e]=!0,f.apply(o,t)}if(!r(g,e)&&!r(_,e))throw new Error("No "+e);return g[e]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function d(e){return function(){return v&&v.config&&v.config[e]||{}}}var f,p,m,h,g={},E={},v={},_={},y=Object.prototype.hasOwnProperty,C=[].slice;m=function(e,t){var n,o=u(e),r=o[0];return e=o[1],r&&(r=a(r,t),n=s(r)),r?e=n&&n.normalize?n.normalize(e,c(t)):a(e,t):(e=a(e,t),o=u(e),r=o[0],e=o[1],r&&(n=s(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},h={require:function(e){return i(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:d(e)}}},f=function(e,t,n,a){var c,u,d,f,p,v,y=[];if(a=a||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,p=0;p<t.length;p+=1)if(f=m(t[p],a),u=f.f,"require"===u)y[p]=h.require(e);else if("exports"===u)y[p]=h.exports(e),v=!0;else if("module"===u)c=y[p]=h.module(e);else if(r(g,u)||r(E,u)||r(_,u))y[p]=s(u);else{if(!f.p)throw new Error(e+" missing "+u);f.p.load(f.n,i(a,!0),l(u),{}),y[p]=g[u]}d=n.apply(g[e],y),e&&(c&&c.exports!==o&&c.exports!==g[e]?g[e]=c.exports:d===o&&v||(g[e]=d))}else e&&(g[e]=n)},e=t=p=function(e,t,n,r,a){return"string"==typeof e?h[e]?h[e](t):s(m(e,t).f):(e.splice||(v=e,t.splice?(e=t,t=n,n=null):e=o),t=t||function(){},"function"==typeof n&&(n=r,r=a),r?f(o,e,t,n):setTimeout(function(){f(o,e,t,n)},4),p)},p.config=function(e){return v=e,v.deps&&p(v.deps,v.callback),p},n=function(e,t,n){t.splice||(n=t,t=[]),r(g,e)||r(E,e)||(E[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("almondLib",function(){}),function(e){function t(e,t){var n,o,i=e.parentNode;if(i||a||(i=document.createDocumentFragment(),i.appendChild(e)),r)return r.call(e,t);for(n=i.querySelectorAll(t),o=n.length;o--;)if(n[o]===e)return!0;return!1}var o=Element.prototype,r=o.matches||o.mozMatchesSelector||o.msMatchesSelector||o.oMatchesSelector||o.webkitMatchesSelector,a=function(){return r?r.call(document.createElement("a"),"a"):!1}();"object"==typeof exports?module.exports=t:"function"==typeof n&&n.amd?n("matches",[],function(){return t}):e.matches=t}(this),function(e){function o(e){function t(e){if(!o(e))throw new Error("delegate(): The argument must be an Element or Document Node");return r=e,t}function n(t,n,o){for(;n&&n!==t;){if(e(n,o))return n;n=n.parentElement}return null}function o(e){return e&&e.nodeName&&(3===e.nodeType||9===e.nodeType)?!0:!1}var r;return t.on=function(e,o,a,i,c){function l(i){(i.delegateTarget=n(r,i.target,o))&&(c===!0&&t(r).off(e,l),a.call(r,i))}return a._delegateWrapper=l,r.addEventListener(e,l,i||!1),a},t.once=function(e,n,o,r){t.on(e,n,o,r,!0)},t.off=function(e,t,n){t._delegateWrapper&&(t=t._delegateWrapper),r.removeEventListener(e,t,n||!1)},t}"object"==typeof exports?module.exports=o(t("matches")):"function"==typeof n&&n.amd?n("delegate",["matches"],o):e.delegate=o(e.matches)}(this),n("common/xhrhelper",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(){var e={httpMethodTypes:{GET:"get",POST:"post",PUT:"put",DELETE:"delete"},sendRequest:function(e,t,n){var o=new XMLHttpRequest;o.addEventListener("load",n.onSuccess,!0),o.addEventListener("error",n.onFailure,!0),o.addEventListener("abort",n.onFailure,!0),"boolean"==typeof n.withCredentials&&(o.withCredentials=n.withCredentials),o.open(e,t,"boolean"==typeof n.async?n.async:!0);for(var r in n.headers)n.headers.hasOwnProperty(r)&&o.setRequestHeader(r,n.headers[r]);n.body?o.send(n.body):o.send()},get:function(t,n){e.sendRequest(e.httpMethodTypes.GET,t,n)},post:function(t,n){e.sendRequest(e.httpMethodTypes.POST,t,n)}};return e}}),n("../native/js/form-handler",["require","exports","module","delegate","common/xhrhelper"],function(e,t,n){var o=e("delegate"),r=e("common/xhrhelper");n.exports=function(){var e={xhrHelper:new r,selectors:{FORM:".js-form",CALL_TO_ACTION:".js-submitForm",ROOT_TOGGLE_ELEMENT:".hasToggleElements",CARD_IFRAME:".js-macaw-cards-iframe-container iframe",SUCCESS_MESSAGE:".PromotionCardFull--SuccessMessage"},classes:{SUCCESS_ELEMENTS:"successElements",ERROR_ELEMENTS:"errorElements"},resizeEvent:null,resizeEventObject:null,init:function(){o(document).on("click",e.selectors.CALL_TO_ACTION,e.submitForm),document.createEvent?(e.resizeEvent=document.createEvent("Event"),e.resizeEvent.initEvent("resize",!0,!0)):document.createEventObject&&(e.resizeEventObject=document.createEventObject("Event"),e.resizeEventObject.eventType="resize")},teardown:function(){o(document).off("click",e.submitForm)},submitForm:function(t){t.preventDefault();var n=document.querySelector(e.selectors.FORM);if(n){var o=e.getFormData(n);e.xhrHelper.sendRequest(e.xhrHelper.httpMethodTypes.POST,n.action,{onSuccess:e.handleSuccessResponse,onFailure:e.handleErrorResponse,body:o,headers:null,withCredentials:!0})}},getFormData:function(e){var t,n,o=new FormData,r=e.querySelectorAll("input");for(t=0;n=r[t];t++)o.append(n.name,n.value);return o},handleSuccessResponse:function(t){try{var n=JSON.parse(t.target.responseText).data;if(n.display){document.querySelector(e.selectors.SUCCESS_MESSAGE).innerHTML=n.display;var o=document.querySelectorAll(e.selectors.SUCCESS_MESSAGE+" a");for(i=0;el=o[i];i++)e.toggleClassOn(el,"js-openLink"),el.setAttribute("data-pe-name","card_url_click")}}catch(r){}e.handleResponse(e.classes.SUCCESS_ELEMENTS,e.classes.ERROR_ELEMENTS)},handleErrorResponse:function(){e.handleResponse(e.classes.ERROR_ELEMENTS,null)},handleResponse:function(t,n){var o=document.querySelector(e.selectors.ROOT_TOGGLE_ELEMENT);o&&(t&&e.toggleClassOn(o,t),n&&e.toggleClassOff(o,n),e.resizeIframe())},toggleClassOff:function(t,n){t.className=t.className.replace(e.getClassStringRegEx(n),"")},toggleClassOn:function(t,n){t.className.match(e.getClassStringRegEx(n))||(t.className+=" "+n)},getClassStringRegEx:function(e){return new RegExp("(?:^|\\s)"+e+"(?!\\S)","g")},resizeIframe:function(){e.resizeEvent?window.dispatchEvent(e.resizeEvent):e.resizeEventObject&&window.fireEvent("on"+e.resizeEventObject.eventType,e.resizeEventObject)}};return e.init(),e}}),function(e){"use strict";function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function o(e){return"undefined"==typeof e}function r(t){return e.xdm=O,y=t,y&&(T="xdm_"+y.replace(".","_")+"_"),C}function a(e){if(!e)throw new Error("url is undefined or empty");if(/^file/.test(e))throw new Error("The file:// protocol is not supported");var t=e.toLowerCase().match(E);if(t){var n=t[2],o=t[3],r=t[4]||"";return("http:"===n&&":80"===r||"https:"===n&&":443"===r)&&(r=""),n+"//"+o+r}return e}function i(e){if(!e)throw new Error("url is undefined or empty");if(e=e.replace(_,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":location.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=location.protocol+"//"+location.host+t+e}for(;v.test(e);)e=e.replace(v,"");return e}function c(e,t){if(!t)throw new Error("parameters is undefined or null");var n=e.indexOf("#"),o=[];for(var r in t)t.hasOwnProperty(r)&&o.push(r+"="+encodeURIComponent(t[r]));return e+(-1===n?"#":"&")+o.join("&")}function l(e,t,n){var o;for(var r in t)t.hasOwnProperty(r)&&(r in e?(o=t[r],"object"==typeof o?l(e[r],o,n):n||(e[r]=t[r])):e[r]=t[r]);return e}function s(e){var t=m.cloneNode(!1);if(l(e.props,{frameBorder:0,allowTRansparency:!0,scrolling:"no",width:"100%",src:c(e.remote,{xdm_e:a(location.href),xdm_c:e.channel,xdm_p:1}),name:T+e.channel+"_provider",style:{margin:0,padding:0,border:0}}),t.id=e.props.name,delete e.props.name,!e.container)throw new Error('xdm.Rpc() configuration object missing a DOM "container" property');return l(t,e.props),e.container.appendChild(t),e.onLoad&&b(t,"load",e.onLoad),e.html&&(t.contentWindow.document.open(),t.contentWindow.document.write(e.html),t.contentWindow.document.close()),e.iframe=t,t}function u(e,t){"string"==typeof e&&(e=[e]);for(var n,o=e.length;o--;)if(n=e[o],n=new RegExp("^"===n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(t))return!0;return!1}function d(e){var t;if(e.isHost=e.isHost||o(w.xdm_p),e.props=e.props||{},e.isHost)e.remote=i(e.remote),e.channel=e.channel||"default"+h++;else if(e.channel=w.xdm_c.replace(/["'<>\\]/g,""),e.remote=w.xdm_e.replace(/["'<>\\]/g,""),e.acl&&!u(e.acl,e.remote))throw new Error("Access denied for "+e.remote);return t=[new C.stack.PostMessageTransport(e)],t.push(new C.stack.QueueBehavior(!0)),t}function f(e){var t,n,o=e.length,r={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(n=0;o>n;n++)t=e[n],l(t,r,!0),0!==n&&(t.down=e[n-1]),n!==o-1&&(t.up=e[n+1]);return t}function p(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var m=document.createElement("IFRAME"),h=Math.floor(1e4*Math.random()),g=Function.prototype,E=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,v=/[\-\w]+\/\.\.\//,_=/([^:])\/\//g,y="",C={},O=e.xdm,T="xdm_",w=function(e){e=e.substring(1,e.length).split("&");for(var t,n={},o=e.length;o--;)t=e[o].split("="),n[t[0]]=decodeURIComponent(t[1]);return n}(location.hash),b=function(){return e.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)}}(),A=function(){return e.removeEventListener?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent("on"+t,n)}}();l(C,{version:"1.0.0",query:w,stack:{},noConflict:r}),C.Rpc=function(e,t){var n;if(t.local)for(var o in t.local)t.local.hasOwnProperty(o)&&(n=t.local[o],"function"==typeof n&&(t.local[o]={method:n}));var r=f(d(e).concat([new C.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=a(e.remote),this.destroy=function(){r.destroy()},r.init(),this.iframe=e.iframe},C.stack.PostMessageTransport=function(t){function n(e){var n=a(e.origin),r="string"==typeof e.data;n===c&&r&&e.data.substring(0,t.channel.length+1)===t.channel+" "&&o.up.incoming(e.data.substring(t.channel.length+1),n)}var o,r,i,c;return o={outgoing:function(e,n,o){i.postMessage(t.channel+" "+e,n||c),o&&o()},destroy:function(){A(e,"message",n),r&&(i=null,r.parentNode.removeChild(r),r=null)},init:function(){if(c=a(t.remote),t.isHost){var l=function(a){a.data===t.channel+"-ready"&&(i="postMessage"in r.contentWindow?r.contentWindow:r.contentWindow.document,A(e,"message",l),b(e,"message",n),setTimeout(function(){o.up.callback(!0)},0))};b(e,"message",l),r=s(t)}else b(e,"message",n),i="postMessage"in e.parent?e.parent:e.parent.document,i.postMessage(t.channel+"-ready",c),setTimeout(function(){o.up.callback(!0)},0)}}},C.stack.QueueBehavior=function(e){function t(){var i;return e===!0&&0===r.length?void p(n):void(a||0===r.length||o||(a=!0,i=r.shift(),n.down.outgoing(i.data,i.origin,function(e){a=!1,i.callback&&setTimeout(function(){i.callback(e)},0),t()})))}var n,o,r=[],a=!0;return n={init:function(){n.down.init()},callback:function(e){a=!1;var o=n.up;t(),o.callback(e)},incoming:function(e,t){n.up.incoming(e,t)},outgoing:function(e,n,o){r.push({data:e,origin:n,callback:o}),t()},destroy:function(){o=!0,n.down.destroy()}}},C.stack.RpcBehavior=function(e,n){function r(e){e.jsonrpc="2.0",c.down.outgoing(JSON.stringify(e))}function a(e,t){var n=Array.prototype.slice;return function(){var o,a=arguments.length,i={method:t};a>0&&"function"==typeof arguments[a-1]?(a>1&&"function"==typeof arguments[a-2]?(o={success:arguments[a-2],error:arguments[a-1]},i.params=n.call(arguments,0,a-2)):(o={success:arguments[a-1]},i.params=n.call(arguments,0,a-1)),s[""+ ++l]=o,i.id=l):i.params=n.call(arguments,0),e.namedParams&&1===i.params.length&&(i.params=i.params[0]),r(i)}}function i(e,n,a,i){if(!a)return void(n&&r({id:n,error:{code:-32601,message:"Procedure not found."}}));var c,l;n?(c=function(e){c=g,r({id:n,result:e})},l=function(e,t){l=g;var o={id:n,error:{code:-32099,message:e}};t&&(o.error.data=t),r(o)}):c=l=g,t(i)||(i=[i]);try{var s=a.method.apply(a.scope,i.concat([c,l]));o(s)||c(s)}catch(u){l(u.message)}}var c,l=0,s={};return c={incoming:function(e){var t,o=JSON.parse(e);o.method?n.handle?n.handle(o,r):i(o.method,o.id,n.local[o.method],o.params):(t=s[o.id],o.error&&t.error?t.error(o.error):t.success&&t.success(o.result),delete s[o.id])},init:function(){if(n.remote)for(var t in n.remote)n.remote.hasOwnProperty(t)&&(e[t]=a(n.remote[t],t));c.down.init()},destroy:function(){for(var t in n.remote)n.remote.hasOwnProperty(t)&&e.hasOwnProperty(t)&&delete e[t];c.down.destroy()}}},"object"==typeof exports?module.exports=C:"function"==typeof provide?provide(C):"function"==typeof n&&n.amd?n("xdm",[],function(){return C}):e.xdm=C}(window),n("unification/logger",["require","exports","module"],function(e,t,n){"use strict";function o(e){return function(){if(window.DEBUG){var t=Array.prototype.slice.apply(arguments);t.unshift(e),console.log.apply(console,t)}}}n.exports=o}),n("common/utils",["require","exports","module","unification/logger"],function(e,t,n){"use strict";var o=e("unification/logger")("[UTILS]"),r={getConfigFromJsonIn:function(e){var t,n=document.getElementById(e),r=null;if(!n)return o(["Element with id",e,"not found"].join(" ")),r;t=n.innerHTML;try{r=JSON.parse(t)}catch(a){o(["Error while parsing json in element",e].join(" "),a)}return r},isEmpty:function(e){return!r.isDefined(e)||"string"==typeof e&&0===e.length},isDefined:function(e){return"undefined"!=typeof e&&null!==e},isObject:function(e){return r.isDefined(e)&&"object"==typeof e},toArray:function(e){return Array.prototype.slice.call(e,0)},escapeHtml:function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML},decodeHtml:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes[0].nodeValue},trigger:function(e,t){var n=new Event(t);e.dispatchEvent(n)},getFollowElements:function(e){var t,n=e&&e.target;if(n){for(;!n.dataset.userId&&n.parentElement;)n=n.parentElement;return t=n.dataset.userId,r.fetchTargetElement("data-user-id",t)}return[]},fetchTargetElement:function(e,t){var n="*["+e+'="'+t+'"]';return r.toArray(document.querySelectorAll(n))},createUrl:function(e,t){var n=e;n+=-1!==n.indexOf("?")?"&":"?";for(var o in t)n=n+encodeURIComponent(o)+"="+encodeURIComponent(t[o])+"&";return n.substr(0,n.length-1)},getTarget:function(e){return e.target},extend:function(e){var t,n,o=Array.prototype.slice.call(arguments,1);for(t in o){var r=o[t];for(n in r)void 0!==r[n]&&(e[n]=r[n])}return e}};n.exports=r}),n("common/video-interface-manager",["require","exports","module","delegate","xdm","common/utils"],function(e,t,n){"use strict";function o(){var e=d.getConfigFromJsonIn("video-config"),t="";return"undefined"!=typeof e&&null!==e&&(t=d.createUrl(e.video_player_url,e.params)),t}function r(){return document.querySelectorAll(".VideoContainer")}function a(){var e=document.getElementById("ExternalIframeContainer");return e&&e.className.match(/\bAmplifyContainer\b/)?e:void 0}function i(e,t){return function(n){var o=Array.prototype.slice.call(arguments),r=o.length-2,a=o.length-1,i=o[r],c=o[a],l=function(e){if("requestPlayerConfig"===n){var o,e=e||{};try{o=JSON.parse(t.getAttribute("data-player-config"))}catch(r){o={}}return d.extend(e,o)}return e};o[r]=function(e){i(l(e))},o[a]=function(){"requestPlayerConfig"===n?i(l()):c(l())},e.callVideoHostMethod.apply(e,o)}}function c(e,t,n){var o=new u.Rpc({remote:t,container:e,isHost:!0},{local:{callVideoHostMethod:i(n,e)},remote:{callMethodByName:{}}});return o.iframe.setAttribute("allowfullscreen",""),o}function l(e){for(var t,n,a,i,l=r(),s=0;s<l.length;s++)t=l[s],n={vmap_url:t.getAttribute("data-src"),image_src:t.getAttribute("data-thumbnail"),content_id:t.getAttribute("data-content-id"),type:t.getAttribute("data-type")},i=d.createUrl(o(),n),a=c(t,i,e),e.attachVideoInterface(a)}function s(e){var t,n,o=a();o&&(t=o.getAttribute("data-player-url"),n=c(o,t,e),e.attachVideoInterface(n))}var u=(e("delegate"),e("xdm")),d=e("common/utils"),f={init:function(e){l(e),s(e)},isSupported:function(){var e=r(),t=a();return e.length>0||"undefined"!=typeof t},getCallVideoHostMethod:i};n.exports=f}),n("../native/js/flex-embed",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(){var e,t,n=document.getElementById("ExternalIframeContainer");n&&(e=n.getAttribute("data-iframe-aspect-ratio-numerator"),t=n.getAttribute("data-iframe-aspect-ratio-denominator"),n.style.paddingBottom=100*t/e+"%")}}),n("../native/js/api-request",["require","exports","module","common/xhrhelper"],function(e,t,n){"use strict";var o=e("common/xhrhelper");n.exports=function(e,t){var n=new o,r=function(){this.status>=200&&this.status<=299?e(this):t(this)},a=function(){t(this)},i={getRequest:function(e,t,o){n.get(e,{onSuccess:r,onFailure:a,body:t,withCredentials:o})},postRequest:function(e,t,o){n.post(e,{onSuccess:r,onFailure:a,body:t,withCredentials:o})}};return i}}),n("../native/js/card-data-broker",["require","exports","module","./api-request"],function(e,t,n){"use strict";var o=e("./api-request");n.exports=function(e){var t,n=function(){var t="/i/cards/api/v1",n=window.location.host,o=window.location.protocol;return void 0!==e.tweetId&&void 0!=e.cardName&&void 0!==e.token&&void 0!==e.forward?o+"//"+n+t+"?tweetid="+e.tweetId+"&cardname="+e.cardName+"&authenticity_token="+e.token+"&forward="+e.forward.toString():void console.log("Missing tweetId/cardName/token/forward in card config: "+e)},r=n(),a={_onDataUpdate:null,register:function(e){a._onDataUpdate=e},unregister:function(){a._onDataUpdate=null},doRead:function(e){if(r){var n=JSON.stringify(e);return t.getRequest(r,n,!0),0}},doWrite:function(e){if(r){var n=JSON.stringify(e);return t.postRequest(r,n,!0),0}},cancel:function(){},cancelAll:function(){}},i=function(t){null!==a._onDataUpdate&&a._onDataUpdate(e.original,JSON.parse(t.response),0)},c=function(e){console.log("Request failed. "+e.responseText)};return t=new o(i,c),a}}),n("../native/js/card-helper",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(){var e={showElement:function(t){var n=e.queryElement(t);n&&(n.style.display="block")},hideElement:function(t){var n=e.queryElement(t);n&&(n.style.display="none")},setContent:function(t,n){var o=e.queryElement(t);o&&(o.innerHTML=n)},queryElement:function(e){var t=document.querySelector(e);return t||console.log('Element with selector "'+e+'" is not found.'),t}};return e}}),n("../native/js/card-page-controller",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(){var e={_currentPage:null,_loadPage:function(e){e&&"function"==typeof e.load&&e.load()},_unloadPage:function(e){e&&"function"==typeof e.unload&&e.unload()},init:function(t){e._loadPage(t),e._currentPage=t},switchToPage:function(t){return t!==e.currentPage?(e._unloadPage(e._currentPage),e._loadPage(t),e._currentPage=t,e._currentPage):void 0},getCurrentPage:function(){return e._currentPage}};return e}}),n("../native/js/poll_shared/card-poll",["require","exports","module","delegate","./../card-data-broker","./../card-helper","./../card-page-controller"],function(e,t,n){"use strict";{var o=(e("delegate"),e("./../card-data-broker"),e("./../card-helper"));e("./../card-page-controller")}n.exports=function(e){var t={attribute:{POLL_OPTION:"data-poll-option",POLL_COMPLETED:"data-poll-completed"},selector:{PAGE_RESULT:".PollCardShared-resultPage",PAGE_VOTING:".PollCardShared-votingPage",CONTAINER:".PollCardShared"},cardHelper:new o,pollContainer:null,pollOptions:null,twitterInterface:e,init:function(){t.pollContainer=document.querySelector(t.selector.CONTAINER),t.pollOptions=t.pollContainer.querySelectorAll(t.selector.PAGE_VOTING+" ["+t.attribute.POLL_OPTION+"]");for(var e,n=0;e=t.pollOptions[n];n++)e.addEventListener("click",t.handleOptionClick);t.pollContainer&&!t.pollContainer.getAttribute(t.attribute.POLL_COMPLETED)&&(t.cardHelper.hideElement(t.selector.PAGE_RESULT),t.twitterInterface.handleResize())},handleOptionClick:function(){var e=this.getAttribute(t.attribute.POLL_OPTION);e&&e.length<140&&(e+=" "),t.twitterInterface.composeTweet({tweetText:e||"",scribeData:t.twitterInterface.config.scribeData});for(var n,o=0;n=t.pollOptions[o];o++)n.removeEventListener("click",t.handleOptionClick);setTimeout(function(){t.cardHelper.showElement(t.selector.PAGE_RESULT),t.cardHelper.hideElement(t.selector.PAGE_VOTING),t.twitterInterface.handleResize()},500)}};return t}}),n("../native/js/consumer-poll/poll2choice-text-only",["require","exports","module","delegate","./../card-data-broker","./../card-helper","./../card-page-controller"],function(e,t,n){"use strict";var o=(e("delegate"),e("./../card-data-broker")),r=e("./../card-helper"),a=e("./../card-page-controller");n.exports=function(e){var t={attributes:{CHOICE_ATTRIBUTE_NAME:"data-poll-choice",STATE_ATTRIBUTE_NAME:"data-choice-state",SELECTED_STATE_VALUE:"selected",OPEN_FOR_VOTE:"data-poll-open"},selectors:{CONTAINER:"div.Poll2ChoiceTextOnly",VOTING_PAGE:"div.Poll2ChoiceTextOnly-page--voting",VOTED_PAGE:"div.Poll2ChoiceTextOnly-page--voted",RESULT_PAGE:"div.Poll2ChoiceTextOnly-page--result",BUTTON:"button.Poll2ChoiceTextOnly-button",SELECTED_CLASS:".Poll2ChoiceTextOnly-text--selected"},actions:{VOTE:"click"},cardHelper:new r,pageController:new a,cardDatabroker:new o({}),userChoice:null,pollContainer:null,twitterInterface:e,_showUserChoice:function(e){var n=e+" div["+t.attributes.CHOICE_ATTRIBUTE_NAME+'="'+t.userChoice+'"] '+t.selectors.SELECTED_CLASS,o=t.cardHelper.queryElement(n);o&&o.setAttribute(t.attributes.STATE_ATTRIBUTE_NAME,t.attributes.SELECTED_STATE_VALUE)},_hideAllPages:function(){t.cardHelper.hideElement(t.selectors.VOTING_PAGE),t.cardHelper.hideElement(t.selectors.VOTED_PAGE),t.cardHelper.hideElement(t.selectors.RESULT_PAGE)},_handleDataUpdate:function(e,n,o){t.pageController.getCurrentPage().onDataUpdate(e,n,o)},_handleOptionClick:function(){var e=t.pageController.getCurrentPage();e&&"function"==typeof e.onVote&&e.onVote(event.target.getAttribute(t.attributes.CHOICE_ATTRIBUTE_NAME))},init:function(){t.pollContainer=document.querySelector(t.selectors.CONTAINER),t.pageController.init("true"===t.pollContainer.getAttribute(t.attributes.OPEN_FOR_VOTE)?t.votingPage:t.resultPage);for(var e,n=t.pollContainer.querySelectorAll(t.selectors.BUTTON),o=0;e=n[o];o++)e.addEventListener(t.actions.VOTE,t._handleOptionClick);t.cardDatabroker.register(t._handleDataUpdate)},deinit:function(){t.cardDatabroker.cancelAll(),t.cardDatabroker.unregister()},resultPage:{load:function(){t._hideAllPages(),t.cardHelper.showElement(t.selectors.RESULT_PAGE),t._showUserChoice(t.selectors.RESULT_PAGE)}},votedPage:{load:function(){t._hideAllPages(),t.cardHelper.showElement(t.selectors.VOTED_PAGE),t._showUserChoice(t.selectors.VOTED_PAGE)},onDataUpdate:function(e,n){n.voteIsOpen||(t.pageController.switchToPage(t.selectors.RESULT_PAGE),t.resultPage.onDataUpdate(e,n))}},votingPage:{load:function(){t._hideAllPages(),t.cardHelper.showElement(t.selectors.VOTING_PAGE)},onVote:function(e){t.userChoice=e,t.pageController.switchToPage(t.votedPage)},onDataUpdate:function(e,n){n.voteIsOpen||(t.pageController.switchToPage(t.resultPage),t.resultPage.onDataUpdate(e,n))}}};return t}}),n("../native/js/initialize",["require","exports","module","./form-handler","common/video-interface-manager","./flex-embed","./poll_shared/card-poll","./consumer-poll/poll2choice-text-only"],function(e,t,n){"use strict";n.exports=function(t){var n={modules:{Interface:t,FormHandler:e("./form-handler"),VideoInterfaceManager:e("common/video-interface-manager"),flexEmbed:e("./flex-embed"),CardPoll:e("./poll_shared/card-poll"),Poll2ChoiceTextOnly:e("./consumer-poll/poll2choice-text-only")},serialization:{CARD:"twitter-cards-serialization",VOTING:"twitter-cards-voting-serialization"},twitterInterface:null,init:function(){var e=n.getSerialization(n.serialization.CARD);e&&n._initCard(e)},getSerialization:function(e){var t,n=document.querySelector('script[type="text/'+e+'"]');try{t=JSON.parse(n.textContent||n.innerHTML)}catch(o){}return t},_initPlayer:function(){n.modules.VideoInterfaceManager.isSupported()&&n.modules.VideoInterfaceManager.init(n.twitterInterface),n.modules.flexEmbed()},_initVoting:function(){var t=n.getSerialization(n.serialization.VOTING);if(t&&"string"==typeof t.cardClassPath)try{var o=e(t.cardClassPath),r=new o(t,n.twitterInterface);r.load()}catch(a){}},_initPoll:function(){var e=new n.modules.CardPoll(n.twitterInterface);e.init()},_initConsumerPoll:function(e){var t=new n.modules.Poll2ChoiceTextOnly(n.twitterInterface);t.init(e)},_initCard:function(e){var t,o=e.scribeData;if(n.twitterInterface=new n.modules.Interface,o&&(t=o.card_name))switch(t){case"__entity_animated_gif":case"__entity_video":case"amplify":case"animated_gif":case"audio":case"player":n._initPlayer();break;case"2427656750:poll_choice2_m":case"2427656750:poll_choice2_r":case"2427656750:poll_choice4_m":case"2427656750:poll_choice4_r":case"2427656750:poll_choice4_rc":case"2427656750:poll_multi_m":case"2427656750:poll_multi_r":n._initPoll();break;case"poll2choice_text_only":n._initConsumerPoll(e);break;case"promotion":{new n.modules.FormHandler}break;case"1856447832:voting_2_choices":n._initVoting()}}};return n.init(),n}}),n("common/throttle",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(e,t){var n,o,r,a,i=0,c=function(){i=new Date,r=null,a=e.apply(n,o)};return function(){var l=new Date,s=t-(l-i);return n=this,o=arguments,0>=s?(clearTimeout(r),r=null,i=l,a=e.apply(n,o)):r||(r=setTimeout(c,s)),a}}}),n("../native/js/utils/text-ellipsis",["require","exports","module"],function(e,t,n){"use strict";n.exports=function(e){for(var t,n=document.querySelectorAll(e),o=100,r=0;t=n[r];r++){var a=t.offsetHeight+1;if(a>0&&t.scrollHeight>0)for(var i=t.textContent.split(""),c=0;o>c&&(t.scrollHeight>a&&i.length>3);c++)i.splice(i.length-3,3),t.textContent=i.join("")+"..."}}}),n("../native/js/interface",["require","exports","module","delegate","common/throttle","xdm","common/utils","./utils/text-ellipsis"],function(e,t,n){"use strict";var o=e("delegate"),r=e("common/throttle"),a=e("xdm"),i=(e("common/utils"),e("./utils/text-ellipsis"));n.exports=function(e){var t={defaultScribe:{DEFAULT_SCRIBE_ELEMENT:"platform_card"},scribeActionNames:{IMPRESSION:"impression",OPEN_LINK:"open_link",OPEN_PHOTO:"click",CARD_CLICK:"card_click"},selectors:{CARD_CLICK:".js-cardClick",CARD_CONTAINER:".TwitterCardsGrid.TwitterCard",CARD_ELLIPSIS:".tcu-textEllipse--multiline",CARD_SERIALIZATION:'script[type="text/twitter-cards-serialization"]',COMPOSE_TWEET:".js-statusComposeTweet",OPEN_BUY_NOW_DIALOG:".js-openBuyNowDialog",OPEN_LEADGEN_CONFIRM_DIALOG:".js-openLeadGenConfirmDialog",OPEN_LINK:".js-openLink",OPEN_PHOTO:".js-openPhoto",OPEN_PROFILE:".js-openProfile",OPEN_GALLERY:".js-openGallery"},dataAttrs:{ACTION:"data-action",CARD_URL:"data-card-url",EARNED:"data-earned",IMPRESSION_ID:"data-impression-id",OPEN_LINK:"data-open-link",P_E_NAME:"data-pe-name",SCREEN_NAME:"data-screen-name",TWEET_TEXT:"data-tweet-text",USER_ID:"data-user-id"},config:null,host:null,hostMethods:null,throttleHandleResize:null,rpcHelpers:{ready:{onReady:function(){t.host.localMethodNames(function(e){t.hostMethods=e,t.handleOnReady(t.hostMethods)})}},methods:{local:{localMethodNames:function(){return{callVideoPlayerMethod:!0}},callVideoPlayerMethod:function(){t.callVideoPlayerMethod.apply(t,arguments)}},remote:{callMethodByName:{},followAdvertiser:{},localMethodNames:{},logPromotedInfo:{},openBuyNowDialog:{},openLeadGenConfirmDialog:{},openLinkNoScribe:{},openPhotoNoScribe:{},openProfile:{},resizeCard:{},scribe:{},statusComposeTweet:{},unfollowAdvertiser:{}}}},teardown:function(){window.removeEventListener("load",t.handleResize,!1),window.removeEventListener("resize",t.throttleHandleResize,!1),o(document).off("click",t.handleStatusComposeTweet),o(document).off("click",t.handleOpenBuyNowDialog),o(document).off("click",t.handleOpenLeadGenConfirmDialog),o(document).off("click",t.handleOpenLink),o(document).off("click",t.handleOpenPhoto),o(document).off("click",t.handleOpenProfile),o(document).off("click",t.handleCardClick),t.host.destroy&&t.host.destroy()},handleOnReady:function(e){e&&(e.statusComposeTweet&&o(document).on("click",t.selectors.COMPOSE_TWEET,t.handleStatusComposeTweet),e.openBuyNowDialog&&o(document).on("click",t.selectors.OPEN_BUY_NOW_DIALOG,t.handleOpenBuyNowDialog),e.openLeadGenConfirmDialog&&o(document).on("click",t.selectors.OPEN_LEADGEN_CONFIRM_DIALOG,t.handleOpenLeadGenConfirmDialog),e.openLinkNoScribe&&o(document).on("click",t.selectors.OPEN_LINK,t.handleOpenLink),e.openPhotoNoScribe&&o(document).on("click",t.selectors.OPEN_PHOTO,t.handleOpenPhoto),e.openProfile&&o(document).on("click",t.selectors.OPEN_PROFILE,t.handleOpenProfile),e.scribe&&o(document).on("click",t.selectors.CARD_CLICK,t.handleCardClick),e.resizeCard&&(t.handleResize(),window.addEventListener("load",t.handleResize,!1),window.addEventListener("resize",t.throttleHandleResize,!1)))},handlePromotedEngagement:function(e){t._logPromotedInfo(e,!0)},handleStatusComposeTweet:function(e){t._isSimpleClick(e)&&(t.host.statusComposeTweet({tweetText:e.delegateTarget.getAttribute(t.dataAttrs.TWEET_TEXT),scribeData:t.config.scribeData}),e.preventDefault())},handleOpenBuyNowDialog:function(e){t.host.openBuyNowDialog({tweetId:t.config.card.tweet_id,scribeData:t.config.scribeData}),t._logPromotedInfo(e,!1),t.handleScribe(e.delegateTarget.getAttribute(t.dataAttrs.ACTION)),e.stopPropagation(),e.preventDefault()},handleOpenLeadGenConfirmDialog:function(e){t.host.openLeadGenConfirmDialog({}),t.handleScribe(t.scribeActionNames.IMPRESSION),e.preventDefault()},handleOpenLink:function(e){var n=e.delegateTarget,o=t._getClosestDataAttribute(n,t.dataAttrs.OPEN_LINK);"a"!==n.nodeName.toLowerCase()&&o&&window.open(o,"_blank"),t.host.openLinkNoScribe({url:n.getAttribute("href"),scribeData:t.config.scribeData}),t.handleScribe(n.hasAttribute(t.dataAttrs.ACTION)?n.getAttribute(t.dataAttrs.ACTION):t.scribeActionNames.OPEN_LINK)},handleOpenPhoto:function(e){var n,o,r,a={photos:[]};if(document.querySelector(t.selectors.OPEN_GALLERY))for(r=document.querySelectorAll(t.selectors.OPEN_PHOTO),n=0;o=r[n];n++)a.photos[n]={imageUrl:o.getAttribute("href"),wasClicked:o===e.delegateTarget};else a.photos.push({imageUrl:e.delegateTarget.getAttribute("href"),wasClicked:!0});a.scribeData=t.config.scribeData,t._isSimpleClick(e)&&(t.host.openPhotoNoScribe(a),t.handleScribe(t.scribeActionNames.OPEN_PHOTO),e.preventDefault())},handleOpenProfile:function(e){t._isSimpleClick(e)&&(t.host.openProfile({userId:e.delegateTarget.getAttribute(t.dataAttrs.USER_ID),userScreenName:e.delegateTarget.getAttribute(t.dataAttrs.SCREEN_NAME),scribeData:t.config.scribeData}),e.preventDefault())},handleCardClick:function(){t.handleScribe(t.scribeActionNames.CARD_CLICK)},handleResize:function(){var e=document.documentElement,n=document.querySelector(t.selectors.CARD_CONTAINER),o=560,r=n.offsetHeight,a=n.offsetWidth;
"function"==typeof t.host.resizeCard&&t.host.resizeCard({height:r+"px"}),320>a&&""!==e.className?e.className="":a>=320&&o>a?e.className="mq-medium":a>=o&&(e.className="mq-medium mq-wide"),i(t.selectors.CARD_ELLIPSIS)},handleScribe:function(e,n){var o=n||t.defaultScribe.DEFAULT_SCRIBE_ELEMENT,e=e,r={customScribe:{element:o,action:e},scribeData:t.config.scribeData};this.host.scribe(r)},attachVideoInterface:function(e){t.videoInterface=e},callVideoPlayerMethod:function(){return t.videoInterface?t.videoInterface.callMethodByName.apply(t.videoInterface,arguments):null},callVideoHostMethod:function(){return t.hostMethods&&t.hostMethods.callMethodByName?t.host.callMethodByName.apply(t.host,arguments):void 0},composeTweet:function(e){t.host.statusComposeTweet(e)},_logPromotedInfo:function(e,n){var o=t._getPromotedEventName(e.delegateTarget);o&&t.host.logPromotedInfo({event:o,impressionId:t._getImpressionId(),earned:!!t._getEarned(),sync:n,scribeData:t.config.scribeData})},_getConfiguration:function(e){var t={},n=document.querySelector(e);if(n)try{t=window.CONFIG=JSON.parse(n.textContent||n.innerText)}catch(o){t.scribeData="error"}else t.scribeData="error";return t},_isSimpleClick:function(e){return!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey||e.which>1)},_getPromotedEventName:function(e){return t._getClosestDataAttribute(e,t.dataAttrs.P_E_NAME)},_getImpressionId:function(){return document.querySelector(t.selectors.CARD_CONTAINER).getAttribute(t.dataAttrs.IMPRESSION_ID)},_getEarned:function(){return document.querySelector(t.selectors.CARD_CONTAINER).getAttribute(t.dataAttrs.EARNED)},_getClosestDataAttribute:function(e,n){var o;return o=e&&"html"!==e.parentElement.nodeName.toLowerCase()?e.getAttribute(n)||t._getClosestDataAttribute(e.parentElement,n):!1}};t.config=t._getConfiguration(t.selectors.CARD_SERIALIZATION);try{t.host=e||new a.Rpc(t.rpcHelpers.ready,t.rpcHelpers.methods)}catch(n){}return t.throttleHandleResize=r(t.handleResize,75),t}}),e.config({baseUrl:"/lib/js",paths:{delegate:"../bower_components/delegate.js/delegate",matches:"../bower_components/matches.js/matches",xdm:"../bower_components/xdm.js/xdm"}}),t(["../native/js/initialize","../native/js/interface"],function(e,t){e(t)}),n("main-native",function(){})}();